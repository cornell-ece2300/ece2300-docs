
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Christopher Batten">
      
      
      
        <link rel="prev" href="../ece2300-lab3ab-music/">
      
      
        <link rel="next" href="../ece2300-lab3cd-custom-song/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Lab 3 (Parts C & D): Music-Player -- FPGA Analysis/Prototyping and Report - ECE 2300 Digital Logic and Computer Organization</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-3-parts-c-d-music-player-fpga-analysisprototype-and-report" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ECE 2300 Digital Logic and Computer Organization" class="md-header__button md-logo" aria-label="ECE 2300 Digital Logic and Computer Organization" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ECE 2300 Digital Logic and Computer Organization
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 3 (Parts C & D): Music-Player -- FPGA Analysis/Prototyping and Report
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cornell-ece2300/ece2300-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    cornell-ece2300/ece2300-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ece2300-tut00-remote-access/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ece2300-sec01-linux/" class="md-tabs__link">
          
  
  Discussion Sections

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ece2300-fpga-primer/" class="md-tabs__link">
          
  
  Lab Assignments

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ece2300-tinyrv1-isa/" class="md-tabs__link">
          
  
  Misc

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ECE 2300 Digital Logic and Computer Organization" class="md-nav__button md-logo" aria-label="ECE 2300 Digital Logic and Computer Organization" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ECE 2300 Digital Logic and Computer Organization
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cornell-ece2300/ece2300-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    cornell-ece2300/ece2300-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-tut00-remote-access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial 0: ECE Linux Server Remote Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-tut01-linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial 1: Linux Development Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-tut02-git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial 2: Git Distributed Version Control System
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Discussion Sections
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Discussion Sections
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-sec01-linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Section 1: Linux Development Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-sec02-verilog-gl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Section 2: Verilog Combinational Gate-Level Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-sec03-verilog-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Section 3: Verilog Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-sec04-lab2-head-start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Section 4: Lab 2 Head Start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-sec05-verilog-rtl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Section 5: Verilog Combinational RTL Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-sec06-lab3-head-start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Section 6: Lab 3 Head Start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-sec07-verilog-mem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Section 7: Verilog Memory Arrays
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Lab Assignments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lab Assignments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-fpga-primer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FPGA Development Primer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab1p1-display/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1 (Parts A & B): Five-Bit Numeric Display -- Implementation and Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab1p2-display/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1 (Parts C & D): Five-Bit Numeric Display -- FPGA Analysis/Prototyping and Report
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab2p1-calc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 2 (Parts A & B): Two-Function Calculator -- Implementation and Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab2-calc-fpga-report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 2 (Parts C & D): Two-Function Calculator -- FPGA Analysis/Prototyping and Report
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab3ab-music/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 3 (Parts A & B): Music-Player -- Implementation and Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lab 3 (Parts C & D): Music-Player -- FPGA Analysis/Prototyping and Report
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab 3 (Parts C & D): Music-Player -- FPGA Analysis/Prototyping and Report
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-simulation-of-a-music-player" class="md-nav__link">
    <span class="md-ellipsis">
      1. Simulation of a Music Player
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-setup-quartus-project" class="md-nav__link">
    <span class="md-ellipsis">
      2. Setup Quartus Project
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-synthesize-analyze-integrate-and-configure-counters" class="md-nav__link">
    <span class="md-ellipsis">
      3. Synthesize, Analyze, Integrate, and Configure Counters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Synthesize, Analyze, Integrate, and Configure Counters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-synthesize-and-analyze-gl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Synthesize and Analyze GL Counter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-synthesize-and-analyze-rtl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Synthesize and Analyze RTL Counter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-integrate-rtl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Integrate RTL Counter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-synthesize-and-configure-the-rtl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Synthesize and Configure the RTL Counter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-synthesize-and-analyze-note-players" class="md-nav__link">
    <span class="md-ellipsis">
      4. Synthesize and Analyze Note Players
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Synthesize and Analyze Note Players">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-synthesize-and-analyze-gl-note-player" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Synthesize and Analyze GL Note Player
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-synthesize-and-analyze-rtl-note-player" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Synthesize and Analyze RTL Note Player
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-integrate-synthesize-and-configure-multi-note-player" class="md-nav__link">
    <span class="md-ellipsis">
      5. Integrate, Synthesize, and Configure Multi-Note Player
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Integrate, Synthesize, and Configure Multi-Note Player">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-integrate" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Integrate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-synthesize-and-configure" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Synthesize and Configure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-integrate-synthesize-and-configure-music-player" class="md-nav__link">
    <span class="md-ellipsis">
      5. Integrate, Synthesize, and Configure Music Player
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Integrate, Synthesize, and Configure Music Player">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-integrate_1" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Integrate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-synthesize-and-configure_1" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Synthesize and Configure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-lab-report-submission" class="md-nav__link">
    <span class="md-ellipsis">
      6. Lab Report Submission
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Lab Report Submission">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-1-introduction-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 1. Introduction (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-2-gate-level-counter-design-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 2. Gate-Level Counter Design (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-3-gate-level-vs-rtl-design-two-paragraphs" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3. Gate-Level vs RTL Design (two paragraphs)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-4-multi-note-and-music-player-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 4: Multi-Note and Music Player (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-5-conclusion-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 5: Conclusion (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab3cd-custom-song/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 3 (Parts C & D) Optional Add-On: Custom Song
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab4ab-proc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 (Parts A, B, & C) TinyRV1 Processor -- Implementation and Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab4d-proc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 (Part D) TinyRV1 Processor -- FPGA Analysis/Prototyping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-lab4ef-proc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 (Parts E & F) TinyRV1 Processor -- FPGA Analysis/Prototyping and Report
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece2300-tinyrv1-isa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TinyRV1 ISA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-simulation-of-a-music-player" class="md-nav__link">
    <span class="md-ellipsis">
      1. Simulation of a Music Player
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-setup-quartus-project" class="md-nav__link">
    <span class="md-ellipsis">
      2. Setup Quartus Project
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-synthesize-analyze-integrate-and-configure-counters" class="md-nav__link">
    <span class="md-ellipsis">
      3. Synthesize, Analyze, Integrate, and Configure Counters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Synthesize, Analyze, Integrate, and Configure Counters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-synthesize-and-analyze-gl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Synthesize and Analyze GL Counter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-synthesize-and-analyze-rtl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Synthesize and Analyze RTL Counter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-integrate-rtl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Integrate RTL Counter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-synthesize-and-configure-the-rtl-counter" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Synthesize and Configure the RTL Counter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-synthesize-and-analyze-note-players" class="md-nav__link">
    <span class="md-ellipsis">
      4. Synthesize and Analyze Note Players
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Synthesize and Analyze Note Players">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-synthesize-and-analyze-gl-note-player" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Synthesize and Analyze GL Note Player
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-synthesize-and-analyze-rtl-note-player" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Synthesize and Analyze RTL Note Player
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-integrate-synthesize-and-configure-multi-note-player" class="md-nav__link">
    <span class="md-ellipsis">
      5. Integrate, Synthesize, and Configure Multi-Note Player
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Integrate, Synthesize, and Configure Multi-Note Player">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-integrate" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Integrate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-synthesize-and-configure" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Synthesize and Configure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-integrate-synthesize-and-configure-music-player" class="md-nav__link">
    <span class="md-ellipsis">
      5. Integrate, Synthesize, and Configure Music Player
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Integrate, Synthesize, and Configure Music Player">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-integrate_1" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Integrate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-synthesize-and-configure_1" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Synthesize and Configure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-lab-report-submission" class="md-nav__link">
    <span class="md-ellipsis">
      6. Lab Report Submission
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Lab Report Submission">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-1-introduction-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 1. Introduction (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-2-gate-level-counter-design-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 2. Gate-Level Counter Design (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-3-gate-level-vs-rtl-design-two-paragraphs" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3. Gate-Level vs RTL Design (two paragraphs)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-4-multi-note-and-music-player-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 4: Multi-Note and Music Player (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-5-conclusion-one-paragraph" class="md-nav__link">
    <span class="md-ellipsis">
      Section 5: Conclusion (one paragraph)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="lab-3-parts-c-d-music-player-fpga-analysisprototype-and-report">Lab 3 (Parts C &amp; D): Music Player - FPGA Analysis/Prototype and Report</h1>
<p>Lab 3 is meant to give you experience designing, implementing, testing,
and prototyping combinational <em>and</em> sequential logic using the Verilog
hardware description language. The lab reinforces several lecture topics
including sequential logic gates, finite-state machines (FSMs), and
sequential building blocks. More specifically, the lab will give students
experience with: latches, flip-flops, and registers; Moore and Mealy
FSMs; and counters. The lab will continue to provide opportunities to
leverage the three key abstraction principles: modularity, hierarchy, and
regularity. The lab will also enable students to better understand the
connection between simulation and prototyping.</p>
<p>With the introduction of sequential logic, our designs can now model more
complex and interesting designs; in particular, designs that can have
real-world applications. You should have already worked in simulation to
verify your music player and all of the submodules in Lab 3 Parts A and
B. In Lab 3 Part C, we will be using the FPGA to emulate these designs,
connecting them to real-world phenomena such as music. By the end of the
lab, you should be able to play a simple song using your design, and
understand the digital logic that allows it to happen.</p>
<p>This handout assumes that you have read and understand the course
tutorials, attended the discussion sections, and successfully completed
Labs 1-2. Here are the steps to get started:</p>
<ul>
<li>Step 1. Find your lab partner</li>
<li>Step 2. Find a free workstation</li>
<li>Step 3. Ask the TAs for a lab check-off sheet (each student needs
    their own check-off sheet)</li>
</ul>
<p>Throughout this handout you will see two kinds tasks: lab check-off tasks
and lab report tasks.</p>
<p>For each <em>lab report task</em> you must take some notes, save a screenshot,
and/or record some data for your lab report. Students can start working
on their lab report during their lab session, but will likely need to
continue working on their lab report after the lab session. The lab
report is due three days after your lab session at 11:59pm.</p>
<p>For each <em>lab check-off task</em> you must raise your hand and have a TA come
to check-off your work. The TA will ask you the questions included as
part of the lab check-off task and the assess your understanding using
the following rubric: mastery; accomplished; emerging; beginning. If the
TA and students together feel the students have not mastered the lab
check-off task, the students are encouraged to take a few minutes and try
again.</p>
<p>In contrast to previous labs, Lab 3 is much more application-oriented. We
will spend less time exploring the design space, and more time exploring
the applications of our design. Because of this, you will need some
additional hardware:</p>
<ul>
<li>A <strong>piezoelectric ("piezo") buzzer</strong>. This is a tiny speaker that can
   play our notes</li>
<li>Four <strong>jumper wires</strong>:<ul>
<li>Two <strong>F-M jumper wires</strong>. These have one "input" and one "output"</li>
<li>Two <strong>F-F jumper wires</strong>. These have two "inputs"</li>
</ul>
</li>
<li>A <strong>USB Drive</strong>. Some of the lab report tasks will require you to
   capture waveforms from the oscilloscope. You should follow the
   instructions to save these on your USB Drive, and transfer them to
   your own laptop before leaving the lab.</li>
</ul>
<p><img alt="" src="../img/lab3-hardware.jpg" /></p>
<p><strong>Real hardware can often be delicate and fragile.</strong> As a general rule,
please do not "force" anything together, and take time and caution when
connecting different components. If you have any questions or need
assistance, please ask the TAs.</p>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 1: Setup FPGA Board and Hardware Supplies</p>
<p>Request an FPGA board and the hardware supplies from the TAs. The TAs
will record the board number and the hardware supply kit number on
your check-off sheet. Use the power cord to plug the FPGA board into
an outlet, and use the USB cable to plug the FPGA board into the
workstation. Do not use the other hardware supplies until instructed
to do so.</p>
</div>
<h2 id="1-simulation-of-a-music-player">1. Simulation of a Music Player</h2>
<p>Before starting to work on an FPGA prototype, you must make sure you have
a working Verilog hardware design that has been <em>thoroughly</em> tested in
simulation. One student should start VS Code on the workstation, log into
the <code>ecelinux</code> servers, source the setup script, and make sure their
individual remote repository is up to date.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>%<span class="w"> </span><span class="nb">source</span><span class="w"> </span>setup-ece2300.sh
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/ece2300/groupXX
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>%<span class="w"> </span>git<span class="w"> </span>pull
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>%<span class="w"> </span>tree
</span></code></pre></div>
<p>Where <code>XX</code> is your group number. Now run all of the tests from a clean
build to ensure your design is fully functional.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/ece2300/groupXX/lab3-music
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>%<span class="w"> </span>trash<span class="w"> </span>build
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>%<span class="w"> </span>mkdir<span class="w"> </span>build
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>%<span class="w"> </span>../configure
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>%<span class="w"> </span>make<span class="w"> </span>check
</span></code></pre></div>
<p>We now need to get the files for your design from <code>ecelinux</code> onto the
workstation. This requires multiple steps.</p>
<ul>
<li>
<p>Step 1. Click <em>Microsoft Edge</em> on the desktop to open a web-browser on
   the workstation to log into GitHub and then find your repository</p>
</li>
<li>
<p>Step 2. Start PowerShell by clicking the <em>Start</em> menu then searching
   for <em>Windows PowerShell</em></p>
</li>
<li>
<p>Step 3. Clone your repo onto the workstation by using this command in
   PowerShell (where <code>netid</code> is your Cornell NetID, <strong>notice we are using
   https!</strong>):</p>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>% git clone https://github.com/cornell-ece2300/groupXX
</span></code></pre></div>
<ul>
<li>
<p>Step 4. In the <em>Connect to GitHub</em> pop-up, click <em>Sign in with your
   browser</em></p>
</li>
<li>
<p>Step 5. You may be asked for your GitHub username again and you may be
   asked to authorize the Git Credential Manager; click <em>authorize
   git-ecosystem</em></p>
</li>
<li>
<p>Step 6. Verify that you have successfully cloned your repo by changing
   into your repo and using <code>tree</code> on the workstation:</p>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>% cd groupXX
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>% tree
</span></code></pre></div>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 2: Verify Tests</p>
<p>Show a TA that your hardware designs are passing all of your tests.
The TA will ask one student to explain the purpose of the note player
control FSM and to show the TA specific lines of code in the GL and
RTL implementation that make this a Moore FSM. The TA will ask the
other student to explain the purpose of the music player control FSM
and to show the TA specific lines of code in the RTL implementation
that make this a Mealy FSM.</p>
</div>
<h2 id="2-setup-quartus-project">2. Setup Quartus Project</h2>
<p>Click <em>Quartus (Quartus Prime 19.1)</em> on the desktop to start Quartus, and
click <em>Run the Quartus Prime software</em>. You might need to try starting
Quartus twice. Setup a new Quartus project using the <em>New Project
Wizard</em>:</p>
<ul>
<li>Directory, Name, Top-Level Entity<ul>
<li>Working directory: <code>C:\Users\netid\lab3</code></li>
<li>Name of this project: <code>lab3</code></li>
<li>Name of top-level design entity: <code>lab3</code></li>
<li>Click <em>Next</em></li>
</ul>
</li>
<li>Directory does not exist. Do you want to create it?<ul>
<li>Click yes</li>
</ul>
</li>
<li>Project Type<ul>
<li>Choose <em>Empty Project</em></li>
<li>Click <em>Next</em></li>
</ul>
</li>
<li>Add Files<ul>
<li>Click triple dots to right of <em>File name</em></li>
<li>Click on <em>This PC</em>, then navigate to your cloned repo by choosing
   <em>Windows (C:) &gt;  Users &gt; netid &gt; netid</em> where <em>netid</em> is your
   Cornell NetID</li>
<li>Shift-click on every Verilog hardware design file (do not include
   any test files)</li>
<li>Click <em>Open</em></li>
<li>Click <em>Next</em></li>
</ul>
</li>
<li>Family, Device, and Board Settings<ul>
<li>Click <em>Board</em> tab</li>
<li>Family: <em>Cyclone V</em></li>
<li>Select <em>DE0-CV Development Board</em></li>
<li>Make sure <em>Create top-level design file</em> is checked</li>
<li>Click <em>Next</em></li>
</ul>
</li>
<li>EDA Tool Settings<ul>
<li>Click <em>Next</em></li>
</ul>
</li>
<li>Summary<ul>
<li>Click <em>Finish</em></li>
</ul>
</li>
</ul>
<p>Since we are now using RTL modeling, there is one new step, similar to
Lab 2. You must choose <em>Assignments &gt; Settings</em> from the menu. Then
select the category <em>Compiler Settings &gt; Verilog HDL Input</em> and under
<em>Verilog version</em> click <em>SystemVerilog</em>. Then click <em>OK</em>.</p>
<h2 id="3-synthesize-analyze-integrate-and-configure-counters">3. Synthesize, Analyze, Integrate, and Configure Counters</h2>
<p>We will start by synthesizing and analyzing the two different counter
implementations. Once we better understand the tradeoffs in these
implementations, we can make high-level conclusions about their tradeoffs.</p>
<div class="admonition note">
<p class="admonition-title">Lab Report Task 1: Gate-Level Counter Block Diagram</p>
<p>Make sure you have the block diagram for your gate-level counter
which you prepared in Part A. If you did not draw a block diagram in
Part A, the you <em>must</em> draw a diagram now. Save this diagram since
you will be annotating it later in the lab.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 3: Discuss Gate-Level Counter Block Diagram</p>
<p>Show a TA your block diagram. Explain how loading a new value works.
Explain how the done signal is implemented.</p>
</div>
<h3 id="31-synthesize-and-analyze-gl-counter">3.1. Synthesize and Analyze GL Counter</h3>
<p>To synthesize and analyze the gate-level counter in isolation first find
the <em>Project Navigator</em> pane and click on <em>Hierarchy</em> to display the
drop-down list. Choose <em>Files</em> and select the <code>Counter_8b_GL.v</code> file.
Right click on the file and choose <em>Select as Top-Level Entity</em>. Then
click on <em>Files</em> to display the drop-down list again. Choose <em>Hierarchy</em>
and confirm that <code>Counter_8b_GL</code> is shown as the only entity.</p>
<p>As in Lab 2, we need to create a <em>timing constraint</em> file. Unlike in Lab
2, we also now need to inform the tools that there is a <em>clock</em> signal as
part of our design. Identifying the clock signal will make the tools work
to ensure that our design has no setup or hold time violations. Similar
to Lab 2, when finished, the design will either "meet timing" (i.e., the
actual critical path delay is less than the constraint and there are no
hold time violations) or "not meet timing" (i.e., the actual critical
path delay is greater than the constraint or there are hold time
violations).</p>
<p>Here are the steps to create a timing constraint file:</p>
<ul>
<li>Choose <em>File &gt; New</em> from the menu</li>
<li>Click <em>Synopsys Design Constraints File</em></li>
<li>Click <em>OK</em></li>
<li>Enter the constraints shown below</li>
<li>Click <em>File &gt; Save</em> from the menu</li>
<li>Name the file <em>timing.sdc</em></li>
<li>Save the file in the <em>lab3</em> directory</li>
</ul>
<p>We will use the following initial constraints:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>set_max_delay -from [all_inputs] -to [all_outputs] 20
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>set_min_delay -from [all_inputs] -to [all_outputs] 0
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>create_clock -name clk -period 20 [get_ports {clk}]
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>set_output_delay -add_delay -clock clk -max 0 [all_outputs]
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>set_output_delay -add_delay -clock clk -min 0 [all_outputs]
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>set_input_delay  -add_delay -clock clk -max 0 [all_inputs]
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>set_input_delay  -add_delay -clock clk -min 0 [all_inputs]
</span></code></pre></div>
<p>These constraints tell the FPGA tools that:</p>
<ul>
<li>Our critical path delay constraint is <code>20ns</code> from all inputs to all
   outputs as well</li>
<li>We have a clock signal named <code>clk</code><ul>
<li>There should be setup time violations with respect to
  <code>clk</code> when the period is <code>20ns</code></li>
<li>There should be no hold time violations with respect to <code>clk</code></li>
</ul>
</li>
<li>The output ports have a setup time of 0 (max constraint) and a hold
   time of 0 (min constraint)</li>
<li>The input ports have clock-to-port propagation delay of 0 (max
   constraint) and a clock-to-port contamination delay of 0 (min
   constraint)</li>
</ul>
<p>Now use the following steps to synthesize your design and then look at
the RTL viewer, technology map viewer, and chip planner.</p>
<ul>
<li>Choose <em>Processing &gt; Start Compilation</em> from the menu</li>
<li>Wait 2-3 minutes for synthesis to complete</li>
<li>RTL Viewer<ul>
<li>Choose <em>Tools &gt; Netlist Viewer &gt; RTL Viewer</em> from the menu</li>
<li>Drill down in the hierarchy to see the netlist for the counter</li>
<li>Does the RTL viewer match your expectations?</li>
<li>Choose <em>File &gt; Close</em> from menu to close the RTL viewer</li>
</ul>
</li>
<li>Technology Map Viewer<ul>
<li>Choose <em>Tools &gt; Netlist Viewer &gt; Technology Map Viewer (Post-Fitting)</em></li>
<li>Drill down into the subtractor all the way to see the
   implementation of the full adder</li>
<li>Does the technology viewer match your expectations?</li>
<li>Choose <em>File &gt; Close</em> from the menu to close the technology map
   viewer</li>
</ul>
</li>
<li>Chip Planner<ul>
<li>Choose <em>Tools &gt; Chip Planner</em> from the menu</li>
<li>Identify where the logic used to implement your design is located
   in the FPGA</li>
<li>Choose <em>File &gt; Close</em> from the menu to close the chip planner</li>
</ul>
</li>
</ul>
<p>The next step is to analyze the area of your design.</p>
<ul>
<li>Choose <em>Processing -&gt; Compilation Report</em> from the menu</li>
<li>Under <em>Table of Contents</em> choose <em>Fitter &gt; Resource Section &gt; Resource
   Usage Summary</em></li>
<li>Look through the report to determine the number of combinational ALUTs
   (configurable look-up tables) that are used for your design</li>
<li>Look through the report to determine the number of dedicated logic
   registers that are used for your design</li>
</ul>
<p>You will be working to fill in this data table:</p>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1b0Ep9hQOy_K2F6YslZt8ExoQcgabWJIXPrI3lRXn1mI/edit?gid=0#gid=0">https://docs.google.com/spreadsheets/d/1b0Ep9hQOy_K2F6YslZt8ExoQcgabWJIXPrI3lRXn1mI/edit?gid=0#gid=0</a></li>
</ul>
<p>Make a copy of this table, and enter in the data for your ripple-carry
adder with a 20ns critical path delay constraint. You can find the number
of 7-input ALUts, 6-input ALUts, etc in the area report. You can find the
dedicated logic registers also in the area report.</p>
<p>The final step is to analyze the timing (i.e., the critical path delay)
of your design. We will analyze timing for the <em>Slow 1100mV 85C Model</em>
which is the default choice in the Timing Analyzer.</p>
<ul>
<li>Choose <em>Tools &gt; Timing Analyzer</em> from the menu</li>
<li>Double-click <em>Update Timing Netlist</em></li>
<li>Choose <em>Reports &gt; Custom Reports &gt; Report Timing</em> from the menu</li>
<li>Report Timing<ul>
<li>Clocks - From clock: <em>clk</em></li>
<li>Clocks - To clock: <em>clk</em></li>
<li>Targets - From: <em>[get_registers *]</em></li>
<li>Targets - To: <em>[get_registers *]</em></li>
<li>Report number of paths: <em>100</em></li>
<li>Click <em>Report Timing</em></li>
</ul>
</li>
<li>Identify the propagation delay of the displayed path</li>
<li>Look at the actual critical path (i.e., <em>Data Arrival Path</em>) which
    shows the longest path from one of the inputs through your
    design to one of the outputs</li>
<li>Choose <em>File &gt; Close</em> from the menu to close the timing analyzer</li>
</ul>
<p>Note that your GL counter will not meet timing. This is because the FPGA
tools do not understand that your gate-level flip-flop is actually a
register (check the number of dedicated logic registers in the area
report to confirm this). The FPGA tools are designed to recognize
specific RTL patterns and infer appropriate sequential logic, but they
are simply not designed to recognize specific GL patterns. Even so, we
can still analyze the critical path in our design.</p>
<p>We will use the following conventions when analyzing the critical path
based on FPGA timing reports. The FPGA timing report will have three
parts:</p>
<ul>
<li>
<p>The clock part of the data arrival path: this is the delay from the
   clock pin to the flip-flop at the start of the path.</p>
</li>
<li>
<p>The data part of the data arrival path: this is the actual propagation
   path delay from one flip-flop to another flop-flop.</p>
</li>
<li>
<p>The clock part of the data required path: this is the delay from the
   clock pin to the flip-flop at the end of the path.</p>
</li>
</ul>
<p>The following timing report illustrates these three parts:</p>
<p><img alt="" src="../img/seq-logic-timing-report.png" /></p>
<p>The above image shows that you should count the delay from the start of
the path until the signal leaves the initial flip-flop or register module
as the clock-to-q delay, and you should count the delay from when the
signal enters the final flip-flop until the end of the path as the setup
time. If you select multiple cells in the <em>Incr</em> column and hover your
mouse it will display a pop-up showing the sum of the delays along that
portion of the path.</p>
<p>Also notice that the propagation path delay and the slack do not add up
to the clock constraint. This is due to clock skew. Clock skew means the
clock reaches the initial and final flip-flops at a different times. You
can calculate the effective clock skew as follows:</p>
<div class="arithmatex">\[t_{skew} = t_{pathdelay} + t_{slack} - t_{constraint}\]</div>
<p>The effective clock skew is different from what you will see in the
timing report because the tools are using a more complicated calculation.
For our purposes you should always use the effective clock skew as
calculated above. A negative effective clock skew means the clock reaches
the final flip-flop before it reaches the initial flip-flop. A positive
effective clock skew means the clock reaches the initial flip-flop before
it reaches the final flip-flop.</p>
<p>Enter the slack and critical path delay in the data table. The
spreadsheet will calculate effective clock skew for you.</p>
<div class="admonition note">
<p class="admonition-title">Lab Report Task 2: Collect Data for Gate-Level Counter</p>
<p>Save your completed data table with your analysis of the gate-level
counter and include it in your report. </p>
<ul>
<li>When generating your timing report, select "File name" to save
   your timing report</li>
<li>You will only need to collect 1 path for this portion</li>
</ul>
<p>Draw the critical path on your
block-level diagram. Annotate the clock-to-q delay, the propagation
delay of each block along the critical path, and the setup time on
your block level diagram. Save the critical path timing report text
file and include it in your report. You only want to save the <em>Data
Arrival Path</em> from the timing report text file. Do NOT include
anything else from the timing report text file. You must format the
critical path with a fixed-width font and size the font such that it
fits on a single page. You might need to delete some rows from the
critical path to make it fit. Try to make sure that the remaining
rows still clearly show where the critical path goes. <strong>If you do not
follow this requirements then we will ignore your critical path in
the lab report.</strong></p>
</div>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 4: Discuss Gate-Level Counter Critical Path</p>
<p>Show a TA your data table and timing report. Explain why there are no
dedicated logic registers. Show a TA the critical path on your block
diagram and clearly show how the delays in the timing report
correspond to the delays annotated on the block diagram.</p>
</div>
<h3 id="32-synthesize-and-analyze-rtl-counter">3.2. Synthesize and Analyze RTL Counter</h3>
<p>Use the same process to synthesize and analyze the RTL counter in
isolation. Remember to change that hardware module to be the top-level
entity. So find the <em>Project Navigator</em> pane and click on <em>Hierarchy</em> to
display the drop-down list. Choose <em>Files</em> and select the
<code>Counter_8b_RTL.v</code> file. Right click on the file and choose <em>Select as
Top-Level Entity</em>. Then click on <em>Files</em> to display the drop-down list
again. Choose <em>Hierarchy</em> and confirm that <code>Counter_8b_RTL</code> is shown as
the only entity.</p>
<p>Go through the same process of looking at the RTL Viewer, Technology Map
Viewer, and the Chip Planner. Spend time looking at the Technology Map
Viewer and try to figure out how the blocks in the Technology Map Viewer
connect to your Verilog implementation. Go through the same process of
determining the area utilization. Do the number of dedicated logic
registers match your expectation? Go through the same process of
conducting a timing analysis. Enter the area, slack, and critical path
delay in the data table. The spreadsheet will calculate effective clock
skew for you.</p>
<p>Your RTL counter <em>should</em> meet timing. This is because the FPGA tools
<em>do</em> understand that your RTL flip-flop is actually a register (check the
number of dedicated logic registers in the area report to confirm this).
As mentioned above, the FPGA tools are designed to recognize specific RTL
patterns and infer appropriate sequential logic. You will likely observe
that the area is much less than the GL implementation and the critical
path is much shorter. This because for the GL counter the tools were not
able to actually do any timing optimization because they did not
understand how the timing constraints connected to the GL flip-flop,
while for the RTL counter the FPGA tools are able to do standard timing
optimization.</p>
<div class="admonition note">
<p class="admonition-title">Lab Report Task 3: Collect Data for RTL Counter</p>
<p>Save your completed data table with your analysis of the RTL counter
and include it in your report. Save a screenshot of the technology
mapper view for your RTL counter. Annotate this screen shot by
circling what logic implements:</p>
<ul>
<li>(1) The storage element that keeps track of the current count</li>
<li>(2) The logic that determines the subtracted count</li>
<li>(3) The logic that determines what should be the next stored count</li>
<li>(4) The logic that determines whether the counter is done</li>
</ul>
<p>Clearly label each circle with the corresponding Verilog code
snippet. Save the critical path timing report text file and include
it in your report. You only want to save the <em>Data Arrival Path</em> from
the timing report text file. Do NOT include anything else from the
timing report text file. You must format the critical path with a
fixed-width font and size the font such that it fits on a single
page. <strong>If you do not follow this requirements then we will ignore
your critical path in the lab report.</strong></p>
</div>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 5: Discuss RTL Counter Technology Mapping</p>
<p>Show a TA your data table and timing report. Justify why the number
of dedicated logic registers makes sense. Show a TA your technology
map screen shot annotated with Verilog code snippets. Explain to the
TA the connection between the Verilog code and the actual low-level
logic gates. Are we convinced that RTL modeling does indeed turn into
low-level logic gates?</p>
</div>
<h3 id="33-integrate-rtl-counter">3.3. Integrate RTL Counter</h3>
<p>We are now ready to demonstrate a counter FPGA prototype using the RTL
implementation. We need to change the top-level entity to be
<code>DE0_CV_golden_top.v</code>. Find the <em>Project Navigator</em> pane and click on
<em>Hierarchy</em> to display the drop-down list. Choose <em>Files</em> and select the
<code>DE0_CV_golden_top.v</code> file. Right click on the file and choose <em>Select as
Top-Level Entity</em>. Then click on <em>Files</em> to display the drop-down list
again. Choose <em>Hierarchy</em> and confirm that <code>DE0_CV_golden_top</code> is shown
as the only entity.</p>
<p>The <em>New Project Wizard</em> creates a top-level Verilog module for us which
has ports for all of the switches, LEDs, seven-segment displays, and pins
on the FPGA development board. We want to implement a counter FPGA
prototype with the following specification:</p>
<p><img alt="" src="../img/lab3-counter-fpga.png" /></p>
<ul>
<li><code>clk</code> should be connected to the first button</li>
<li><code>rst</code> should be connected to the reset button on the board</li>
<li><code>load</code> should be connected to the second button</li>
<li><code>done</code> should be assigned to the first LED</li>
<li>Two seven-segment displays for the current input <code>in</code> to the counter</li>
<li>Two seven-segment displays for the current count</li>
</ul>
<p>Note that FPGA's reset (<code>RESET_N</code>) and all of the buttons are
<em>active-low</em>. Unpressed buttons output a logic one and pressed buttons
output a logic zero. Here is a template you can use for your top-level
design.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="w">  </span><span class="n">Counter_8b_RTL</span><span class="w"> </span><span class="n">counter</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="p">.</span><span class="n">clk</span><span class="w">      </span><span class="p">(),</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="p">.</span><span class="n">rst</span><span class="w">      </span><span class="p">(),</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="w">     </span><span class="p">(),</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="w">       </span><span class="p">(),</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="p">.</span><span class="n">count</span><span class="w">    </span><span class="p">(),</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="p">.</span><span class="n">done</span><span class="w">     </span><span class="p">()</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">  </span><span class="n">Display_GL</span><span class="w"> </span><span class="n">display0</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="w">       </span><span class="p">(),</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_tens</span><span class="w"> </span><span class="p">(),</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_ones</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">  </span><span class="n">Display_GL</span><span class="w"> </span><span class="n">display1</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="w">       </span><span class="p">(),</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_tens</span><span class="w"> </span><span class="p">(),</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_ones</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">  </span><span class="p">);</span>
</span></code></pre></div>
<p>You just need to copy this code into the <em>DE0_CV_golden_top.v</em> file and
connect the ports appropriately. You may need to declare additional
internal wires. Look carefully at the labels on the board to figure out
how the switches, buttons, and seven-segment displays correspond to ports
in the top-level Verilog module. We also need to update our timing
constraint file as follows:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>set_max_delay -from [all_inputs] -to [all_outputs] 20
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>set_min_delay -from [all_inputs] -to [all_outputs] 0
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>create_clock -name clk -period 20 [get_ports {KEY[0]}]
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>set_output_delay -add_delay -clock clk -max 0 [all_outputs]
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>set_output_delay -add_delay -clock clk -min 0 [all_outputs]
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>set_input_delay  -add_delay -clock clk -max 0 [all_inputs]
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>set_input_delay  -add_delay -clock clk -min 0 [all_inputs]
</span></code></pre></div>
<h3 id="34-synthesize-and-configure-the-rtl-counter">3.4. Synthesize and Configure the RTL Counter</h3>
<p>From here, choose  <em>Processing &gt; Start Compilation</em> from the menu to
synthesize your design. Once completed, we can configure the FPGA:</p>
<ul>
<li>Choose <em>Tools &gt; Programmer</em> from the menu</li>
<li>Click <em>Hardware Setup</em></li>
<li>Currently selected hardware: <em>USB-Blaster [USB-0]</em></li>
<li>Click <em>Close</em></li>
<li>Click <em>Start</em></li>
</ul>
<p>Additionally, on <code>ecelinux</code>, go ahead and build and run the counter
interactive simulator:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/ece2300/groupXX/lab3-music/build
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>%<span class="w"> </span>make<span class="w"> </span>counter-sim
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>%<span class="w"> </span>./counter-sim<span class="w"> </span>+switches<span class="o">=</span><span class="m">00111</span>
</span></code></pre></div>
<p>Try out your counter simulator for a few values, and make sure that the
FPGA behaves identically.</p>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 6: Demonstrate the RTL Counter</p>
<p>First, show a TA the counter interactive simulator, demonstrating its
functionality. The TA will give you a switch configuration. You
should first predict what your counter will do, then demonstrate it
in simulation. Then demonstrate that your counter on the FPGA
produces identical results for the same stimulus. Additionally,
demonstrate that your counter can take in new values at any time, and
will stop counting down once it reaches 0. Clearly explain to the TA
why the counter prototype is different from the calculator prototype
in Lab 2; explain how the counter prototype illustrates sequential
logic.</p>
</div>
<h2 id="4-synthesize-and-analyze-note-players">4. Synthesize and Analyze Note Players</h2>
<p>In this part, we will synthesize and analyze the gate-level and RTL note
players to continue to understand the connection between gate-level and
RTL modeling.</p>
<h3 id="41-synthesize-and-analyze-gl-note-player">4.1. Synthesize and Analyze GL Note Player</h3>
<p>Use the same process to synthesize and analyze the GL note player in
isolation that we used with the GL counter. Remember to change that
hardware module to be the top-level entity. So find the <em>Project
Navigator</em> pane and click on <em>Hierarchy</em> to display the drop-down list.
Choose <em>Files</em> and select the <code>NotePlayer_GL.v</code> file. Right click on the
file and choose <em>Select as Top-Level Entity</em>. Then click on <em>Files</em> to
display the drop-down list again. Choose <em>Hierarchy</em> and confirm that
<code>NotePlayer_GL</code> is shown as the only entity.</p>
<p>You will need to use the following constraints.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>set_max_delay -from [all_inputs] -to [all_outputs] 20
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>set_min_delay -from [all_inputs] -to [all_outputs] 0
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>create_clock -name clk -period 20 [get_ports {clk}]
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>set_output_delay -add_delay -clock clk -max 0 [all_outputs]
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>set_output_delay -add_delay -clock clk -min 0 [all_outputs]
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>set_input_delay  -add_delay -clock clk -max 0 [all_inputs]
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>set_input_delay  -add_delay -clock clk -min 0 [all_inputs]
</span></code></pre></div>
<p>Go through the same process of determining the area utilization. Do the
number of dedicated logic registers match your expectation? You can go to
<em>Table of Contents</em> and choose <em>Fitter &gt; Resource Section &gt; Resource
Utilization by Entity</em> to determine how many logic gates and registers
are used in every module in your design. Go through the same process of
conducting a timing analysis. As mentioned before, your GL design will
not meet timing, but we can still look at the critical path. Enter the
area, slack, and critical path delay in the data table. The spreadsheet
will calculate effective clock skew for you.</p>
<div class="admonition note">
<p class="admonition-title">Lab Report Task 4: Collect Data for GL Note Player</p>
<p>Save your completed data table with your analysis of the GL note
player and include it in your report.</p>
</div>
<h3 id="42-synthesize-and-analyze-rtl-note-player">4.2. Synthesize and Analyze RTL Note Player</h3>
<p>Use the same process to synthesize and analyze the RTL note player in
isolation that we used with the RTL counter. Remember to change that
hardware module to be the top-level entity. So find the <em>Project
Navigator</em> pane and click on <em>Hierarchy</em> to display the drop-down list.
Choose <em>Files</em> and select the <code>NotePlayer_RTL.v</code> file. Right click on the
file and choose <em>Select as Top-Level Entity</em>. Then click on <em>Files</em> to
display the drop-down list again. Choose <em>Hierarchy</em> and confirm that
<code>NotePlayer_RTL</code> is shown as the only entity.</p>
<p>Go through the same process of determining the area utilization. Do the
number of dedicated logic registers match your expectation? You can go to
<em>Table of Contents</em> and choose <em>Fitter &gt; Resource Section &gt; Resource
Utilization by Entity</em> to determine how many logic gates and registers
are used in every module in your design. Go through the same process of
conducting a timing analysis. As mentioned before, your RTL design
<em>should</em> meet timing. Enter the area, slack, and critical path delay in
the data table. The spreadsheet will calculate effective clock skew for
you.</p>
<div class="admonition note">
<p class="admonition-title">Lab Report Task 5: Collect Data for RTL Note Player</p>
<p>Save your completed data table with your analysis of the RTL note
player and include it in your report.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 7: Discuss GL vs RTL Note Players</p>
<p>Show a TA your data table and timing report. Justify why the number
of dedicated logic registers makes sense. Are we convinced that RTL
modeling does indeed turn into low-level logic gates?</p>
</div>
<h2 id="5-integrate-synthesize-and-configure-multi-note-player">5. Integrate, Synthesize, and Configure Multi-Note Player</h2>
<p>Once we've analyzed our note player, we can move on to using our
multi-note player and actually begin to play notes!</p>
<h3 id="51-integrate">5.1. Integrate</h3>
<p>Similar to before, make sure that <code>DE0_CV_golden_top</code> is the top-level
entity. We want to implement a multi-note player FPGA prototype with the
following specification:</p>
<p><img alt="" src="../img/lab3-multinoteplayer-fpga.png" /></p>
<ul>
<li><code>clk</code> and <code>rst</code> are connected appropriately</li>
<li><code>note1_period</code>, <code>note2_period</code>, etc are set as described below</li>
<li><code>play_load</code> is connected to the first push button</li>
<li><code>play_note</code> is connected to the right three switches</li>
<li><code>play_duration</code> is set to <code>16'hBEBC</code> (resulting in a one second duration)</li>
<li><code>play_done</code> is connected to the first LED</li>
<li><code>note</code> is connected to the <code>GPIO_0[0]</code> pin</li>
<li>One seven-segment display for <code>play_note</code> (note specified on switches)</li>
<li>One seven-segment display for <code>note_sel</code> (currently playing note)</li>
</ul>
<p>The note periods should be set according to the following table (see Part
A for more details):</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>                   period   freq
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>port         hex     (ms)   (Hz) note
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>note1_period 8&#39;h7b   5.12 195.31 G3
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>note2_period 8&#39;h6d   4.55 219.95 A3
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>note3_period 8&#39;h61   4.06 246.61 B3
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>note4_period 8&#39;h5b   3.81 262.52 C4
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>note5_period 8&#39;h51   3.40 294.15 D4
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>note6_period 8&#39;h48   3.03 329.92 E4
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>note7_period 8&#39;h44   2.87 348.77 F4
</span></code></pre></div>
<p>Note that FPGA's reset (<code>RESET_N</code>) and all of the buttons are
<em>active-low</em>. Unpressed buttons output a logic one and pressed buttons
output a logic zero. Here is a template you can use for your top-level
design.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="n">clk</span><span class="p">;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="n">ClockDiv_RTL</span><span class="p">#(</span><span class="mh">9</span><span class="p">)</span><span class="w"> </span><span class="n">clock_div</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="p">.</span><span class="n">clk_in</span><span class="w">  </span><span class="p">(</span><span class="n">CLOCK_50</span><span class="p">),</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="p">.</span><span class="n">rst</span><span class="w">     </span><span class="p">(</span><span class="o">~</span><span class="n">RESET_N</span><span class="p">),</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="p">.</span><span class="n">clk_out</span><span class="w"> </span><span class="p">(</span><span class="n">clk</span><span class="p">)</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">  </span><span class="n">MultiNotePlayer_RTL</span><span class="w"> </span><span class="n">note_player</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">    </span><span class="p">.</span><span class="n">clk</span><span class="w">           </span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">    </span><span class="p">.</span><span class="n">rst</span><span class="w">           </span><span class="p">(),</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">    </span><span class="p">.</span><span class="n">note1_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h7b</span><span class="p">),</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">    </span><span class="p">.</span><span class="n">note2_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h6d</span><span class="p">),</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">    </span><span class="p">.</span><span class="n">note3_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h61</span><span class="p">),</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">    </span><span class="p">.</span><span class="n">note4_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h5b</span><span class="p">),</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">    </span><span class="p">.</span><span class="n">note5_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h51</span><span class="p">),</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">    </span><span class="p">.</span><span class="n">note6_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h48</span><span class="p">),</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">    </span><span class="p">.</span><span class="n">note7_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h44</span><span class="p">),</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">    </span><span class="p">.</span><span class="n">play_load</span><span class="w">     </span><span class="p">(),</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">    </span><span class="p">.</span><span class="n">play_note</span><span class="w">     </span><span class="p">(),</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">    </span><span class="p">.</span><span class="n">play_duration</span><span class="w"> </span><span class="p">(),</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">    </span><span class="p">.</span><span class="n">play_done</span><span class="w">     </span><span class="p">(),</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">    </span><span class="p">.</span><span class="n">note_sel</span><span class="w">      </span><span class="p">(),</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">    </span><span class="p">.</span><span class="n">note</span><span class="w">          </span><span class="p">()</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">  </span><span class="n">Display_GL</span><span class="w"> </span><span class="n">display0</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="w">       </span><span class="p">(),</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_tens</span><span class="w"> </span><span class="p">(</span><span class="cm">/* not used */</span><span class="p">),</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_ones</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="w">  </span><span class="n">Display_GL</span><span class="w"> </span><span class="n">display1</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="w">       </span><span class="p">(),</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_tens</span><span class="w"> </span><span class="p">(</span><span class="cm">/* not used */</span><span class="p">),</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_ones</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">  </span><span class="p">);</span>
</span></code></pre></div>
<p>Notice we are using a clock divider. The on-board clock signal
(<code>CLOCK_50</code>) is a 50MHz clock. This is far too fast to have our notes be
audible. The <code>ClockDiv</code> module divides the clock (decreases the
frequency) by a parametrizable amount. To perform the necessary clock
division by a factor of <span class="arithmatex">\(2^{10}\)</span> for our desired clock frequency of
<span class="arithmatex">\(\approx48828\text{Hz}\)</span> we need to set the <code>ClockDiv</code> parameter to 9.</p>
<p>You just need to copy this code into the <em>DE0_CV_golden_top.v</em> file and
connect the ports appropriately. You may need to declare additional
internal wires. Look carefully at the labels on the board to figure out
how the switches, buttons, and seven-segment displays correspond to ports
in the top-level Verilog module. We also need to update our timing
constraint file as follows:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>set_max_delay -from [all_inputs] -to [all_outputs] 20
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>set_min_delay -from [all_inputs] -to [all_outputs] 0
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>create_clock -period 20 [get_ports {CLOCK_50}]
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>create_clock -name clk -period 20 [get_nets {ClockDiv_RTL:clock_div|count[9]}]
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>set_output_delay -add_delay -clock clk -max 0 [all_outputs]
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>set_output_delay -add_delay -clock clk -min 0 [all_outputs]
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>set_input_delay -add_delay -clock clk -max 0 [all_inputs]
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>set_input_delay -add_delay -clock clk -min 0 [all_inputs]
</span></code></pre></div>
<p>Note that we still specify <code>clk</code> to be <code>20ns</code>; this is over-constrained
based on our actual clock signal, but for our designs, it shouldn't make
a difference.</p>
<h3 id="52-synthesize-and-configure">5.2. Synthesize and Configure</h3>
<p>From here, choose <em>Processing &gt; Start Compilation</em> from the menu to
synthesize your design. Go through the same process of determining the
area utilization. Do the number of dedicated logic registers match your
expectation? You can go to <em>Table of Contents</em> and choose <em>Fitter &gt;
Resource Section &gt; Resource Utilization by Entity</em> to determine how many
logic gates and registers are used in every module in your design. Go
through the same process of conducting a timing analysis. Enter the area,
slack, and critical path delay in the data table. The spreadsheet will
calculate effective clock skew for you.</p>
<p>Now configure the FPGA:</p>
<ul>
<li>Choose <em>Tools &gt; Programmer</em> from the menu</li>
<li>Click <em>Hardware Setup</em></li>
<li>Currently selected hardware: <em>USB-Blaster [USB-0]</em></li>
<li>Click <em>Close</em></li>
<li>Click <em>Start</em></li>
</ul>
<p>Additionally, on <code>ecelinux</code>, go ahead and build and run the multi-note
player interactive simulator:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/ece2300/groupXX/lab3-music/build
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>%<span class="w"> </span>make<span class="w"> </span>multi-note-player-sim
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>%<span class="w"> </span>./multi-note-player-sim<span class="w"> </span>+switches<span class="o">=</span><span class="m">111</span>
</span></code></pre></div>
<p>Open the resulting <code>multi-note-player-sim.vcd</code> in VSCode using Surfer.
You must display these signals in this order: <code>clk</code>, <code>play_note</code>,
<code>note_sel</code>, <code>note7_player.state</code>, and <code>note</code>. Select the note signal in
the waveform viewer. Right-click on a rising edge of <code>note</code> to place a
marker there, and use the arrow keys to navigate your cursor to the next
rising edge to measure the period of the note (one rising edge to the
next). Choose <em>Settings &gt; Time Unit &gt; ms</em> to display the period in
milliseconds. Take a screen shot and record the period.</p>
<p>We will now determine the period for our FPGA prototype using an
oscilloscope. An oscilloscope is a kind of electronic test equipment that
graphically displays analog signals (i.e., voltage). We first need to
connect wires to the pin which produces the note and a reference ground.
Recall that the <code>note</code> port was connected to pin <code>GPIO_0[0]</code> on the FPGA
board. The excerpt from the manual below shows where the <code>GPIO_0[0]</code> pin
is located.</p>
<p><img alt="" src="../img/lab3-gpio-location.png" /></p>
<p>Connect the two <strong>F-M Jumper Wires</strong>:</p>
<ul>
<li>Connect the input of one to the first GPIO of <code>GPIO_0</code> (look on the
   board for the label)</li>
<li>Connect the input of the other to ground</li>
</ul>
<p>Now we need to connect these wires to the oscilloscope. Use the button on
the top of the oscilloscope (on the left) to turn it on and find the main
probe and the ground clip attached to Channel 1.</p>
<p><img alt="" src="../img/lab3-oscilloscope.png" /></p>
<p>Now carefully follow these steps (ask a TA if you need help):</p>
<ul>
<li>There is a small slide switch on the probe that chooses between 1x and
    10x; make sure it is set to 10x</li>
<li>Connect the main probe of <code>CH 1</code> to <code>GPIO_0[0]</code></li>
<li>Connect the ground clip of <code>CH 1</code> to ground</li>
<li>Click on <em>DEFAULT SETUP</em> to first go to the default setup for the
   oscilloscope</li>
<li>Click the <em>CH 2 MENU</em> button<ul>
<li>Clicking this repeatedly will toggle whether Channel 2 is displayed
  We only need one channel; turn Channel 2 off, then click <em>MEASURE</em>
  to return to the main measurement window</li>
</ul>
</li>
<li>Adjust the <em>VOLTS/DIV</em> dial of <code>CH 1</code> to achieve a scale of 1.00V
   (referencing the bottom-left of the display)</li>
<li>Adjust the <em>POSITION</em> dial of <code>CH 1</code> so that the static bar is about
   25% of the way from the bottom of the display</li>
<li>Adjust the <em>SEC/DIV</em> dial to achieve a time division of 2.50ms
   (referencing the bottom-middle of the display)</li>
<li>Press <em>TRIG MENU</em><ul>
<li>Make sure that <em>Type</em> is <code>EDGE</code>, <em>Source</em> is <code>CH 1</code>, and <em>Slope</em>
  is <code>RISING</code> (adjusting any if needed). Once done, click <em>MEASURE</em>
  to go back to the main measurement window</li>
</ul>
</li>
<li>Using the <em>LEVEL</em> dial of the Trigger setup, adjust the trigger to
   be 1.00V (referencing the bottom-right of the display). This tells
   the oscilloscope at what value to capture a signal change.</li>
</ul>
<p>You should initially see static. Try playing a note using your multi-note
FPGA prototype; you should see a waveform! Try different notes. Now,
let's capture this data from the oscilloscope:</p>
<ul>
<li>Press <em>SINGLE SEQ</em> to start a single capture</li>
<li>Play a note on the FPGA. You should see the captured waveform on the
   oscilloscope</li>
<li>Press <em>CURSOR</em>:<ul>
<li>Change <em>Type</em> to <code>TIME</code> by pressing the button next to it repeatedly</li>
<li>Using the buttons to the right of the display, click on <em>Cursor 1</em>.
  Using the large dial next the display, adjust the cursor to be on a
  positive edge of the note. Similarly, adjust Cursor 2 to be on a
  neighboring positive edge</li>
<li>Note the value of <span class="arithmatex">\(\Delta t\)</span> shown on the side - does it match your
  simulation?</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Lab Report Task 6: Collect Data for Multi-Note Player</p>
<p>Save your completed data table with your analysis of the multi-note
player and include it in your report. Save a screenshot of your
simulated waveform for a specific note which clearly shows the period
of that note. Save a screenshot of your actual waveform from the
oscilloscope for the same note which clearly shows the period of this
same note. To obtain a screen capture from the oscilloscope use these
steps:</p>
<ul>
<li>Insert the USB Drive into the port on the front of the oscilloscope</li>
<li>Get the waveform you want to capture<ul>
<li>This image should include both cursors, as well as the value of
  <span class="arithmatex">\(\Delta t\)</span></li>
</ul>
</li>
<li>Press "PRINT" on the oscilloscope to save a screen capture to the
   USB Drive<ul>
<li>A clock will appear on the side panel. This will take a minute
  to save; just be patient.</li>
</ul>
</li>
</ul>
<p>This image will save in a new folder on the drive as a <code>.BMP</code> file
(for which there are converters online to other image types). Once
saved, you can connect the drive to either your own computer or the
lab machine to get the image.</p>
</div>
<p>We are now ready to play notes using our multi-note FPGA prototype!</p>
<ul>
<li>Swap the <strong>F-M Jumper Wires</strong> for <strong>F-F Jumper Wires</strong>, connected
   similarly</li>
<li>Connect the other ends of the jumper wires to the piezo buzzer</li>
</ul>
<p>Now, when you play a note, you should be able to hear the piezo buzzer
make a sound. Vary the switches, and verify that the resulting note
differs in frequency.</p>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 8: Demonstrate the Multi-Note Player</p>
<p>The TA will give you a configuration for the switches. First,
simulate the configuration with your <code>multi-note-player-sim</code> and show
the simulated waveform. You must find the state output for the note
payer that corresponds to the note you are playing and explain how
the states of the note payer FSM correspond to the generated note
waveform. Next, connect the FPGA to the oscilloscope and show the
waveform on the oscilloscope for the same note. Finally, connect the
piezo buzzer to the FPGA, and demonstrate that you can play the
desired note. You do not need to measure the period for the TA, but
make sure you have that data for your lab report.</p>
</div>
<h2 id="5-integrate-synthesize-and-configure-music-player">5. Integrate, Synthesize, and Configure Music Player</h2>
<p>We are finally ready to play some tunes with our music player!</p>
<h3 id="51-integrate_1">5.1. Integrate</h3>
<p>Similar to before, make sure that <code>DE0_CV_golden_top</code> is the top-level
entity. We want to implement a music player FPGA prototype with the
following specification:</p>
<p><img alt="" src="../img/lab3-musicplayer-fpga.png" /></p>
<ul>
<li><code>clk</code> and <code>rst</code> are connected appropriately</li>
<li><code>note1_period</code>, <code>note2_period</code>, etc are set as in multi-note player</li>
<li><code>song_sel</code> is connected to the right five switches</li>
<li><code>start_song</code> is connected to the first push button</li>
<li><code>idle</code> is connected to the first LED</li>
<li><code>note_duration</code> is set to <code>16'h2000</code> (resulting in a short but audible note)</li>
<li><code>note</code> is connected to the <code>GPIO_0[0]</code> pin</li>
<li>Two seven-segment displays for <code>song_sel</code> (song specified on switches)</li>
<li>Two seven-segment displays for <code>note_sel</code> (currently playing note)</li>
</ul>
<p>We provide you the appropriate top-level connections to implement this
specification below.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="n">clk</span><span class="p">;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="n">ClockDiv_RTL</span><span class="p">#(</span><span class="mh">9</span><span class="p">)</span><span class="w"> </span><span class="n">clock_div</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="p">.</span><span class="n">clk_in</span><span class="w">  </span><span class="p">(</span><span class="n">CLOCK_50</span><span class="p">),</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="p">.</span><span class="n">rst</span><span class="w">     </span><span class="p">(</span><span class="o">~</span><span class="n">RESET_N</span><span class="p">),</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="p">.</span><span class="n">clk_out</span><span class="w"> </span><span class="p">(</span><span class="n">clk</span><span class="p">)</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">  </span><span class="kt">logic</span><span class="w">  </span><span class="p">[</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">note_sel</span><span class="p">;</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">  </span><span class="kt">logic</span><span class="w">        </span><span class="n">memreq_val</span><span class="p">;</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">memreq_addr</span><span class="p">;</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">memresp_data</span><span class="p">;</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">  </span><span class="n">MusicPlayer_RTL</span><span class="w"> </span><span class="n">player</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">    </span><span class="p">.</span><span class="n">clk</span><span class="w">           </span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">    </span><span class="p">.</span><span class="n">rst</span><span class="w">           </span><span class="p">(</span><span class="o">~</span><span class="n">RESET_N</span><span class="p">),</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">    </span><span class="p">.</span><span class="n">song_sel</span><span class="w">      </span><span class="p">(</span><span class="n">SW</span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]),</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="w">    </span><span class="p">.</span><span class="n">start_song</span><span class="w">    </span><span class="p">(</span><span class="o">~</span><span class="n">KEY</span><span class="p">[</span><span class="mh">0</span><span class="p">]),</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="w">    </span><span class="p">.</span><span class="n">state</span><span class="w">         </span><span class="p">(</span><span class="cm">/* not used */</span><span class="p">),</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="w">    </span><span class="p">.</span><span class="n">idle</span><span class="w">          </span><span class="p">(</span><span class="n">LEDR</span><span class="p">[</span><span class="mh">0</span><span class="p">]),</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="w">    </span><span class="p">.</span><span class="n">note_duration</span><span class="w"> </span><span class="p">(</span><span class="mh">16&#39;h2000</span><span class="p">),</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="w">    </span><span class="p">.</span><span class="n">note1_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h7B</span><span class="p">),</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="w">    </span><span class="p">.</span><span class="n">note2_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h6D</span><span class="p">),</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="w">    </span><span class="p">.</span><span class="n">note3_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h61</span><span class="p">),</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="w">    </span><span class="p">.</span><span class="n">note4_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h5B</span><span class="p">),</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="w">    </span><span class="p">.</span><span class="n">note5_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h51</span><span class="p">),</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="w">    </span><span class="p">.</span><span class="n">note6_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h48</span><span class="p">),</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="w">    </span><span class="p">.</span><span class="n">note7_period</span><span class="w">  </span><span class="p">(</span><span class="mh">8&#39;h44</span><span class="p">),</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="w">    </span><span class="p">.</span><span class="n">note_sel</span><span class="w">      </span><span class="p">(</span><span class="n">note_sel</span><span class="p">),</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="w">    </span><span class="p">.</span><span class="n">note</span><span class="w">          </span><span class="p">(</span><span class="n">GPIO_0</span><span class="p">[</span><span class="mh">0</span><span class="p">]),</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="w">    </span><span class="p">.</span><span class="n">memreq_val</span><span class="w">    </span><span class="p">(</span><span class="n">memreq_val</span><span class="p">),</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="w">    </span><span class="p">.</span><span class="n">memreq_addr</span><span class="w">   </span><span class="p">(</span><span class="n">memreq_addr</span><span class="p">),</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="w">    </span><span class="p">.</span><span class="n">memresp_data</span><span class="w">  </span><span class="p">(</span><span class="n">memresp_data</span><span class="p">)</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="w">  </span><span class="n">MusicMem_RTL</span><span class="w"> </span><span class="n">mem</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a><span class="w">    </span><span class="p">.</span><span class="n">memreq_val</span><span class="w">    </span><span class="p">(</span><span class="n">memreq_val</span><span class="p">),</span>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span class="w">    </span><span class="p">.</span><span class="n">memreq_addr</span><span class="w">   </span><span class="p">(</span><span class="n">memreq_addr</span><span class="p">),</span>
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a><span class="w">    </span><span class="p">.</span><span class="n">memresp_data</span><span class="w">  </span><span class="p">(</span><span class="n">memresp_data</span><span class="p">)</span>
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a>
</span><span id="__span-13-47"><a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a><span class="w">  </span><span class="n">Display_GL</span><span class="w"> </span><span class="n">display0</span>
</span><span id="__span-13-48"><a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-13-49"><a id="__codelineno-13-49" name="__codelineno-13-49" href="#__codelineno-13-49"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="w">       </span><span class="p">(</span><span class="n">note_sel</span><span class="p">),</span>
</span><span id="__span-13-50"><a id="__codelineno-13-50" name="__codelineno-13-50" href="#__codelineno-13-50"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_tens</span><span class="w"> </span><span class="p">(</span><span class="n">HEX1</span><span class="p">),</span>
</span><span id="__span-13-51"><a id="__codelineno-13-51" name="__codelineno-13-51" href="#__codelineno-13-51"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_ones</span><span class="w"> </span><span class="p">(</span><span class="n">HEX0</span><span class="p">)</span>
</span><span id="__span-13-52"><a id="__codelineno-13-52" name="__codelineno-13-52" href="#__codelineno-13-52"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-13-53"><a id="__codelineno-13-53" name="__codelineno-13-53" href="#__codelineno-13-53"></a>
</span><span id="__span-13-54"><a id="__codelineno-13-54" name="__codelineno-13-54" href="#__codelineno-13-54"></a><span class="w">  </span><span class="n">Display_GL</span><span class="w"> </span><span class="n">display1</span>
</span><span id="__span-13-55"><a id="__codelineno-13-55" name="__codelineno-13-55" href="#__codelineno-13-55"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-13-56"><a id="__codelineno-13-56" name="__codelineno-13-56" href="#__codelineno-13-56"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="w">       </span><span class="p">(</span><span class="n">SW</span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]),</span>
</span><span id="__span-13-57"><a id="__codelineno-13-57" name="__codelineno-13-57" href="#__codelineno-13-57"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_tens</span><span class="w"> </span><span class="p">(</span><span class="n">HEX3</span><span class="p">),</span>
</span><span id="__span-13-58"><a id="__codelineno-13-58" name="__codelineno-13-58" href="#__codelineno-13-58"></a><span class="w">    </span><span class="p">.</span><span class="n">seg_ones</span><span class="w"> </span><span class="p">(</span><span class="n">HEX2</span><span class="p">)</span>
</span><span id="__span-13-59"><a id="__codelineno-13-59" name="__codelineno-13-59" href="#__codelineno-13-59"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-13-60"><a id="__codelineno-13-60" name="__codelineno-13-60" href="#__codelineno-13-60"></a>
</span><span id="__span-13-61"><a id="__codelineno-13-61" name="__codelineno-13-61" href="#__codelineno-13-61"></a><span class="w">  </span><span class="c1">// turn off remaining seven segment displays</span>
</span><span id="__span-13-62"><a id="__codelineno-13-62" name="__codelineno-13-62" href="#__codelineno-13-62"></a><span class="w">  </span><span class="k">assign</span><span class="w"> </span><span class="n">HEX4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">7</span><span class="mb">&#39;b1111111</span><span class="p">;</span>
</span><span id="__span-13-63"><a id="__codelineno-13-63" name="__codelineno-13-63" href="#__codelineno-13-63"></a><span class="w">  </span><span class="k">assign</span><span class="w"> </span><span class="n">HEX5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">7</span><span class="mb">&#39;b1111111</span><span class="p">;</span>
</span></code></pre></div>
<p>You just need to copy this code into the <em>DE0_CV_golden_top.v</em> file. Our
timing constraint file should be the same as in the multi-note player.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>set_max_delay -from [all_inputs] -to [all_outputs] 20
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>set_min_delay -from [all_inputs] -to [all_outputs] 0
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>create_clock -period 20 [get_ports {CLOCK_50}]
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>create_clock -name clk -period 20 [get_nets {ClockDiv_RTL:clock_div|count[9]}]
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>set_output_delay -add_delay -clock clk -max 0 [all_outputs]
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>set_output_delay -add_delay -clock clk -min 0 [all_outputs]
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>set_input_delay -add_delay -clock clk -max 0 [all_inputs]
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>set_input_delay -add_delay -clock clk -min 0 [all_inputs]
</span></code></pre></div>
<h3 id="52-synthesize-and-configure_1">5.2. Synthesize and Configure</h3>
<p>From here, choose <em>Processing &gt; Start Compilation</em> from the menu to
synthesize your design. Go through the same process of determining the
area utilization. Do the number of dedicated logic registers match your
expectation? You can go to <em>Table of Contents</em> and choose <em>Fitter &gt;
Resource Section &gt; Resource Utilization by Entity</em> to determine how many
logic gates and registers are used in every module in your design. Go
through the same process of conducting a timing analysis. Enter the area,
slack, and critical path delay in the data table. The spreadsheet will
calculate effective clock skew for you.</p>
<p>Now configure the FPGA:</p>
<ul>
<li>Choose <em>Tools &gt; Programmer</em> from the menu</li>
<li>Click <em>Hardware Setup</em></li>
<li>Currently selected hardware: <em>USB-Blaster [USB-0]</em></li>
<li>Click <em>Close</em></li>
<li>Click <em>Start</em></li>
</ul>
<p>Additionally, on <code>ecelinux</code>, go ahead and build and run the music player
interactive simulator:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/ece2300/groupXX/lab3-music/build
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>%<span class="w"> </span>make<span class="w"> </span>music-player-sim
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>%<span class="w"> </span>./music-player-sim<span class="w"> </span>+switches<span class="o">=</span><span class="m">000</span>
</span></code></pre></div>
<p>Open the resulting <code>multi-note-player-sim.vcd</code> in VSCode using Surfer.
You must display these signals in this order: <code>clk</code>, <code>song_sel</code>,
<code>note_sel</code>, and <code>note</code>. Zoom in so you can see the first three or four
notes. Take a screen shot.</p>
<p>Confirm that the piezo buzzer is wired correctly to the FPGA board.</p>
<ul>
<li>Swap the <strong>F-M Jumper Wires</strong> for <strong>F-F Jumper Wires</strong>, connected
   similarly</li>
<li>Connect the other ends of the jumper wires to the piezo buzzer</li>
</ul>
<p>Now try playing song zero. Then try playing song one. What songs is your
music player playing?</p>
<div class="admonition note">
<p class="admonition-title">Lab Report Task 7: Collect Data for Multi-Note Player</p>
<p>Save your completed data table with your analysis of the music
player and include it in your report. Save a screenshot of your
simulated waveform for the the first song which clearly shows the
first three or four notes.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 9: Demonstrate the Music Player</p>
<p>The TA will ask you to use your music player to play song 0 and song
1. To demonstrate mastery, you must clearly explain to the TA how the
counter, note player FSM, and music player FSM all work together to
play these songs. The TA will then ask you to play a hidden song and
identify what song it is.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Lab Check-Off Task 10: Turn In FPGA Board</p>
<p>When you are finished with your demo, pack up your FPGA development
board. Neatly put the board, power cable, and USB cable back in the
box. <strong>Make sure to copy the oscilloscope screenshot from the USB
drive to your laptop. Please delete any images that are on the USB
drive.</strong> Put the piezo buzzer, jumper wires, and the USB drive back
in the zip lock. Return the box to a TA who will then record the
board number on your check-off sheet, initial the final check-off,
and then collect your check-off sheet.</p>
</div>
<h2 id="6-lab-report-submission">6. Lab Report Submission</h2>
<p>Students should work with their partner to prepare a short lab report
that conveys what they have learned in this lab assignment. The lab
report should start with no more than two pages of text. Students should
include all figures, tables, and diagrams after these two pages in an
appendix. The appendix can be as many pages as necessary. Do not
interleave the text, figures, tables, and diagrams. There should be two
pages of text and then the appendix with all of the text, figures,
tables, and diagrams.</p>
<p>There are no restrictions on font size, margins, or line spacing, but
please make sure your report is readable. We recommend using 10pt Times
or 10pt Palintino with 0.75in to 1in margins. Please make sure you
include a title, your names, and your NetIDs at the top of the first
page. Do not include a title page.</p>
<p>The lab report must include the following numbered sections. Please
number your sections and use these specific titles. Please follow the
guidelines on the number of paragraphs, the content of each paragraph,
and which figures/tables to include. Some paragraphs might just be 2-3
sentences.</p>
<h4 id="section-1-introduction-one-paragraph">Section 1. Introduction (one paragraph)</h4>
<ul>
<li>Include 2-3 sentences explaining what the lab involves</li>
<li>Include one sentence explaining the purpose of this lab (why are
    students doing this lab?)</li>
<li>Include one sentence explicitly connecting the lab to one or more
    lecture topics; be specific on which lecture topics this lab
    reinforces with experiential learning</li>
</ul>
<h4 id="section-2-gate-level-counter-design-one-paragraph">Section 2. Gate-Level Counter Design (one paragraph)</h4>
<ul>
<li>Include a sentence referencing your block diagram</li>
<li>Include one sentence describing how you implemented your subtractor</li>
<li>Include 2-3 sentences that describe how your counter works including
    how it loads in new counter values and how to implements the done
    signal</li>
</ul>
<h4 id="section-3-gate-level-vs-rtl-design-two-paragraphs">Section 3. Gate-Level vs RTL Design (two paragraphs)</h4>
<ul>
<li>
<p>Paragraph 1: Analyzing the Gate-Level Counter and Note Player</p>
<ul>
<li>Include a sentence referencing the critical path of your GL counter</li>
<li>Discuss the delay of the various components along the critical path
  (you must mention clock-to-q and setup time)</li>
<li>Explain why the GL counter and GL note players do not meet timing
   and do not have any dedicated logic registers</li>
</ul>
</li>
<li>
<p>Paragraph 2: Analyzing the RTL Counter and Note Player</p>
<ul>
<li>Include a sentence referencing your technology map screenshot</li>
<li>Discuss how the various Verilog constructs turn into specific
   low-level hardware in the FPGA</li>
<li>Discuss whether or not the number of dedicated logic registers in
   the RTL counter and RTL note player as expected</li>
<li>Be specific and count registers in your Verilog and argue why the
   number of dedicated logic registers is correct in both the counter
   and the note player</li>
</ul>
</li>
</ul>
<h4 id="section-4-multi-note-and-music-player-one-paragraph">Section 4: Multi-Note and Music Player (one paragraph)</h4>
<ul>
<li>Briefly reference your simulated waveforms and your oscilloscope
   waveforms for your multi-note player</li>
<li>Explain what note you tried, the expected note period, the measured
   note period in simulation, and the measured note period using the
   oscilloscope</li>
</ul>
<h4 id="section-5-conclusion-one-paragraph">Section 5: Conclusion (one paragraph)</h4>
<ul>
<li>Include 2-3 sentences that summarizes all of the data and analysis
    in this lab assignment</li>
<li>Include a sentence that draws a high-level conclusion; how will
    what you have learned impact your design work throughout the rest
    of the semester?</li>
</ul>
<h4 id="appendix">Appendix</h4>
<ul>
<li>FPGA Data Table</li>
<li>Block diagram for GL counter with highlighted critical path and
     annotated delays</li>
<li>Technology map viewer for RTL counter annotated with Verilog code snippets</li>
<li>Critical path report for GL counter <strong>(1 page max, fixed width font!)</strong></li>
<li>Critical path report for RTL counter <strong>(1 page max, fixed width font!)</strong></li>
<li>Simulated waveform screenshot for multi-note player clearly showing
    note period</li>
<li>Oscilloscope waveform screenshot for multi-note player clearly showing
    note period</li>
<li>Simulated waveform screenshot for first song which clearly shows the
    first few notes</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Christopher Batten
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../js/extras.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.1.0/skins/default.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.1.0/wavedrom.min.js"></script>
      
        <script src="../js/wavedrom_loader.js"></script>
      
    
  </body>
</html>